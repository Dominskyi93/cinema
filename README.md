# Cinema-App

Cinema-App is a web application created for educational and demonstration purposes. It mimics a ticket reservation system in a cinema and provides users with the ability to register and log in using their personal credentials. The app also has a role-based authorization system for both regular users and administrators.

The database already has an injection:
- ADMIN: admin@gmail.com : 1234
- USER: user@gmail.com : 1234

## Architecture

- REST API
- SOLID principles
- The architecture of the project is based on the 3-layer model:
    - The presentation layer comprises the controllers
    - The application layer comprises the services
    - The data access layer comprises the DAO

## Functionalities

- Register a new user
- Login (username and password)
- Role-based authorization (admin, user)
- Exception handling (invalid username, password, invalid role) with descriptive messages
- Project has multiple endpoints with user and admin access
    - POST: `/register` (to create a user) - `ALL`
    - POST: `/cinema-halls` (to create a cinema hall) - `ADMIN`
    - POST: `/movies` (to create a movie) - `ADMIN`
    - POST: `/movie-sessions` (to create a movie sessions) - `ADMIN`
    - POST: `/orders/complete` (to create an order for the current user) - `USER`
    - PUT: `/movie-sessions/{id}` (to update a movie session) - `ADMIN`
    - PUT: `/shopping-carts/movie-sessions` (to add movie session to shopping cart) - `USER`
    - DELETE: `/movie-sessions/{id}` (to delete a movie session) - `ADMIN`
    - GET: `/orders` (to get order history for the current user) - `USER`
    - GET: `/shopping-carts/by-user` (to get a shopping cart for the current user) - `USER`
    - GET: `/cinema-halls` (to get all cinema halls) - `USER` or `ADMIN`
    - GET: `/movies` (to get all movies) - `USER` or `ADMIN`
    - GET: `/movie-sessions/available` (to get all available movies by date) - `USER` or `ADMIN`
    - GET: `/users/by-email` (to find user by email) - `ADMIN`
- All endpoints send and receive JSON data, except for the login page, which is generated by Spring Security. Almost all endpoints are secured by role-based authorization. More details can be found in the SecurityConfig class.

## Package Structure
#### The package structure of the project includes:
- `config`: This package contains Spring configuration files that define the application context and provide configuration for various beans.
- `controller`: This package contains the controllers for the different endpoints of the REST API. These controllers receive requests from clients, perform any necessary business logic, and send responses back to clients.
- `dao`: This package contains the data access layer (also known as the repository layer) that is responsible for accessing and manipulating data in the database. The DAO calls CRUD (Create, Read, Update, Delete) methods on the database.
- `dto`: This package contains data transfer objects that are used to encapsulate and transfer data between the different layers of the application. These objects help to unify requests and responses in the controllers.
- `lib`: This package contains email and password validators with their annotations. These validators help to ensure that the data provided by the user is valid and meets the requirements of the application.
- `model`: This package contains the models for the database. These models are used to represent data entities in the database and are used by the DAO to map database records to Java objects.
- `service`: This package contains the services that call the repositories and the Authentication class. These services are responsible for performing business logic and coordinating the interactions between the controllers and the DAO.
- `mapper`: This package contains mapper classes that convert model objects to DTO objects. These mappers help to simplify the conversion process between database records and Java objects.

## Technologies

- Java 17
- Apache Maven
- Apache Tomcat - version 9.0.73
- MySQL
- Hibernate
- Spring:
    - Core
    - Web Mvc
    - Security

## How to Run and Test

WARNING: You must have Tomcat and MySQL installed to run this project.

To configure the database connection settings, modify the `db.properties` file located in `resources/db.properties`. After that, create a local Tomcat configuration in IntelliJ and run it to deploy the application. Once the application is up and running, you can access it at localhost:8080.

To test the application, you can use the mock admin and user accounts with the credentials 
- ADMIN (username: admin@gmail.com and password: 1234)
- USER (username: user@gmail.com and password: 1234).